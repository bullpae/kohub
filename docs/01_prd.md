# kohub PRD (제품 요구사항 정의)

## 1. 목적
MSP(Managed Service Provider) 운영자가 모니터링, 장애 대응, 이력 관리, 고객 커뮤니케이션을 하나의 허브에서 수행하도록 지원한다. 주요 목표는 **장애 대응 시간 단축**, **가시성 강화**, **이력/지식 축적**이다.

## 2. 목표 사용자
- MSP 관리자: 시스템 전체 운영/정책/리포트 관리
- MSP 운영자: 장애 대응 및 일상 운영
- 접수 담당자: 티켓 분류/배정
- 고객사 관리자: 자사 서비스 현황 파악
- 고객: 서비스 요청 및 진행 상황 확인

## 3. 문제 정의
- 모니터링, 티켓, 터미널, 리포트가 분산되어 있어 **컨텍스트 스위칭 비용**이 크다.
- 장애 대응 이력이 시스템별로 분산되어 **재사용이 어렵다**.
- 고객과의 커뮤니케이션이 **상태 기반으로 표준화**되어 있지 않다.

## 4. 성공 지표 (KPI)
- 평균 MTTR 20% 단축
- 장애 티켓의 자동 생성 비율 70% 이상
- 운영자 1인당 동시 대응 가능한 티켓 수 30% 증가
- 고객 포털에서의 상태 조회 이용률 50% 이상

## 5. 핵심 사용자 시나리오
- 모니터링 이벤트 발생 → 티켓 자동 생성 → 터미널 즉시 접속 → 해결 기록 → 고객 확인
- 고객 포털 요청 → 티켓 생성 → 담당자 배정 → 진행 상태 추적

## 6. 범위 (Phase 1 MVP)
### 포함
- Host CRUD
- Ticket CRUD + 상태 전이
- Keycloak 기반 인증/권한
- Uptime Kuma Webhook 수신
- Termix iframe 연동
- 기본 대시보드 (요약/티켓/알림)

### 제외 (Phase 2+)
- AI 추천/RAG
- Prometheus 어댑터
- Slack/Teams 알림
- Ansible 자동화/런북

## 7. 기능 요구사항
### 7.1 대시보드
- 장애/경고/정상 요약 통계 제공
- 미처리 티켓 목록/알림 표시
- 실시간 상태 갱신(WebSocket)

### 7.2 티켓
- 상태 전이(NEW→RECEIVED→ASSIGNED→IN_PROGRESS→RESOLVED→COMPLETED→CLOSED)
- 담당자 배정 및 변경
- 해결 방법 기록 및 활동 로그

### 7.3 호스트
- 호스트 등록/수정/비활성화
- 태그 및 상태 관리

### 7.4 인증/권한
- Keycloak OIDC 로그인
- 역할 기반 접근 제어(RBAC)

### 7.5 어댑터
- Uptime Kuma Webhook 수신
- Termix iframe 세션 연결

## 8. 비기능 요구사항
- 가용성: 99.9% 목표
- 응답 시간: 95% 요청이 500ms 이하
- 감사 로그: 티켓 상태 변경, 로그인, 권한 변경 기록
- 보안: HTTPS 강제, JWT 서명 검증
- 백업: DB 일일 백업, 7일 보관

## 9. 제약 및 가정
- MSP 고객사는 조직 단위로 격리된다.
- Keycloak이 모든 인증/권한의 단일 진입점이다.
- 1차 릴리스에서는 단일 DB/단일 리전 운영을 가정한다.

## 10. 완료 기준 (MVP)
- 호스트/티켓 CRUD API와 UI 제공
- Uptime Kuma 이벤트로 티켓 자동 생성
- Termix iframe으로 터미널 접속 가능
- 주요 역할별 접근 제어 작동
- 기본 대시보드에서 장애/티켓 현황 확인 가능
